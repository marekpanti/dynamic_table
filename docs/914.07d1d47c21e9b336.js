"use strict";(self.webpackChunkdynamicTable=self.webpackChunkdynamicTable||[]).push([[914],{2914:(W,f,r)=>{r.r(f),r.d(f,{TableModule:()=>j});var i=r(4006),p=r(5932);const C=["id","firstName","lastName","account","actions"];var d=r(5412),t=r(4650),m=r(6895),h=r(4859),b=r(3546);function w(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",4),t.NdJ("click",function(){const c=t.CHM(e).index,u=t.oxw(2);return t.KtG(u.change(c))}),t._uU(1),t.qZA()}if(2&o){const e=a.$implicit,n=a.index,l=t.oxw(2);t.ekj("selected",n===l.currentColumnIndex),t.xp6(1),t.AsE(" ",n," : ",e," ")}}function x(o,a){if(1&o&&(t.TgZ(0,"mat-card"),t.YNc(1,w,2,4,"div",3),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.data)}}let v=(()=>{class o{constructor(e,n){this.dialogRef=e,this.data=n,this.currentColumnIndex=null,this.newPositionColumnIndex=null}change(e){if(null===this.currentColumnIndex)this.currentColumnIndex=e;else{this.newPositionColumnIndex=e;const n=this.data[this.newPositionColumnIndex];this.data[this.newPositionColumnIndex]=this.data[this.currentColumnIndex],this.data[this.currentColumnIndex]=n,this.currentColumnIndex=null,this.newPositionColumnIndex=null}}close(){this.dialogRef.close(null)}save(){this.dialogRef.close([...this.data])}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(d.so),t.Y36(d.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["column-order"]],decls:9,vars:1,consts:[[4,"ngIf"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],["class","item",3,"selected","click",4,"ngFor","ngForOf"],[1,"item",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"h2"),t._uU(1,"Switch column positions"),t.qZA(),t.TgZ(2,"p"),t._uU(3,"Select your first column which you would like to switch, then select its new position."),t.qZA(),t.YNc(4,x,2,1,"mat-card",0),t.TgZ(5,"button",1),t.NdJ("click",function(){return n.close()}),t._uU(6,"Cancel"),t.qZA(),t.TgZ(7,"button",2),t.NdJ("click",function(){return n.save()}),t._uU(8,"Save"),t.qZA()),2&e&&(t.xp6(4),t.Q6J("ngIf",n.data))},dependencies:[m.sg,m.O5,h.lW,b.a8],styles:[".item[_ngcontent-%COMP%]{padding:.2rem;border:1px solid #9a9a9a;border-radius:5px;margin:.2rem;font-size:14px;font-weight:700}.item[_ngcontent-%COMP%]:active{background:#ebebeb}.selected[_ngcontent-%COMP%]{background:rgb(173,173,173)}mat-card[_ngcontent-%COMP%]{margin:1rem auto}"]}),o})();var Z=r(5762),_=r(1086);let T=(()=>{class o extends Z.ObservableStore{constructor(){super({trackStateHistory:!0}),this.setState({table:[],timeOuts:{}},"INIT_STATE")}get(){const{table:e}=this.getState();return(0,_.of)(e||null)}add(e){let n=this.getState().table,l=null;n.find((u,K)=>(l=K,u.id===e.id))?n[l]={...e}:n=[...n,e],this.setState({table:n},"ADD_ROW_TO_TABLE")}changeUndoState(e){let n=this.getState().table;const l=n.findIndex(c=>c.id===e);n[l].showUndo=!n[l].showUndo,this.setState({table:n},"CHANGE_UNDO_STATE")}removeRow(e){let n=this.getState().table;const l=n.findIndex(c=>c.id===e);n.splice(l,1),this.setState({table:n},"REMOVE_ROW_ID")}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var y=r(4850);let N=(()=>{class o{precise(e){return Math.round(parseFloat((e*Math.pow(10,5)).toFixed(5)))/Math.pow(10,5)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),g=(()=>{class o{constructor(e,n){this.store=e,this.tableService=n,this.timeOuts={}}removeRow(e){this.store.changeUndoState(e),this.timeOuts[e]=setTimeout(()=>{this.store.removeRow(e)},3e3)}addToStore(e){const n={...e,showUndo:!1};this.store.add(n)}undoRemove(e){clearTimeout(this.timeOuts[e]),this.store.changeUndoState(e),this.timeOuts[e]=null}calculateTotalAccounts(){return this.store.stateChanged.pipe((0,y.U)(e=>{let l,n=0;if(e.table.length>0){l=e.table.map(c=>c.account);for(let c in l)n=this.tableService.precise(n+l[c])}return n}))}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(T),t.LFG(N))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var I=r(3336),S=r(9549),A=r(4144),s=r(671);let O=(()=>{class o{constructor(e){this.facade=e,this.finalCalcul$=this.facade.calculateTotalAccounts()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(g))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-summary"]],decls:5,vars:3,template:function(e,n){1&e&&(t.TgZ(0,"p"),t._uU(1,"Together in all accounts: "),t.TgZ(2,"strong"),t._uU(3),t.ALo(4,"async"),t.qZA()()),2&e&&(t.xp6(3),t.Oqu(t.lcZ(4,1,n.finalCalcul$)))},dependencies:[m.Ov]}),o})();function U(o,a){1&o&&(t.TgZ(0,"th",19),t._uU(1,"ID"),t.qZA())}function F(o,a){if(1&o&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.xp6(1),t.Oqu(e.id)}}function R(o,a){1&o&&(t.TgZ(0,"th",19),t._uU(1,"First Name"),t.qZA())}function D(o,a){1&o&&(t.TgZ(0,"td",21)(1,"mat-form-field"),t._UZ(2,"input",22),t.qZA()()),2&o&&t.Q6J("formGroupName",a.index)}function k(o,a){1&o&&(t.TgZ(0,"th",19),t._uU(1,"Account"),t.qZA())}function J(o,a){1&o&&(t.TgZ(0,"td",21)(1,"mat-form-field"),t._UZ(2,"input",23),t.qZA()()),2&o&&t.Q6J("formGroupName",a.index)}function Y(o,a){1&o&&(t.TgZ(0,"th",19),t._uU(1,"Last Name"),t.qZA())}function M(o,a){1&o&&(t.TgZ(0,"td",21)(1,"mat-form-field"),t._UZ(2,"input",24),t.qZA()()),2&o&&t.Q6J("formGroupName",a.index)}function Q(o,a){1&o&&(t.TgZ(0,"th",19),t._uU(1,"actions"),t.qZA())}function G(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(e);const l=t.oxw().$implicit,c=t.oxw();return t.KtG(c.removeRow(l.id))}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA()()}}function q(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const l=t.oxw().$implicit,c=t.oxw();return t.KtG(c.undoDelete(l.id))}),t._uU(1," undo "),t.qZA()}}function P(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"td",25)(1,"button",26),t.NdJ("click",function(){const c=t.CHM(e).index,u=t.oxw();return t.KtG(u.saveRow(c))}),t.TgZ(2,"mat-icon"),t._uU(3,"done"),t.qZA()(),t.YNc(4,G,3,0,"button",27),t.YNc(5,q,2,0,"button",28),t.qZA()}if(2&o){const e=a.$implicit,n=a.index,l=t.oxw();t.Q6J("formGroupName",n),t.xp6(1),t.Q6J("disabled",!l.myForm.valid),t.xp6(3),t.Q6J("ngIf",!e.showUndo),t.xp6(1),t.Q6J("ngIf",e.showUndo)}}function E(o,a){1&o&&t._UZ(0,"tr",31)}function B(o,a){1&o&&t._UZ(0,"tr",32)}function H(o,a){1&o&&(t.TgZ(0,"p",33),t._uU(1," Form mast be valid and all fields filled "),t.qZA())}const z=[{path:"",component:(()=>{class o{constructor(e,n,l){this.store=e,this.facade=n,this.dialog=l,this.displayedColumns=C,this.countId=0,this.myForm=new i.cw({testField:new i.NI("testValue"),rows:new i.Oe([this.initRows(0)])})}ngOnInit(){this.saveRow(0),this.store.stateChanged.subscribe(e=>{this.dataSource=e.table})}initRows(e){return new i.cw({firstName:new i.NI("test",i.kI.required),lastName:new i.NI("",i.kI.required),account:new i.NI(null,i.kI.required),id:new i.NI(e)})}openChangeOrderColumnsDialog(){this.dialog.open(v,{width:"400px",data:[...this.displayedColumns]}).afterClosed().subscribe(e=>{e&&(this.displayedColumns=[...e])})}saveRow(e){this.facade.addToStore(this.myForm.controls.rows.value[e])}removeRow(e){this.facade.removeRow(e)}addRows(){this.countId++,this.myForm.controls.rows.push(this.initRows(this.countId)),this.store.add(this.myForm.controls.rows.value[this.countId])}undoDelete(e){this.facade.undoRemove(e)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(T),t.Y36(g),t.Y36(d.uw))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-table"]],decls:31,vars:6,consts:[[1,"content"],["mat-raised-button","","color","primary",3,"click"],["novalidate","",3,"formGroup"],["matInput","","formControlName","testField",1,"form-control"],["formArrayName","rows"],["mat-table","",1,"table",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","firstName"],["mat-cell","",3,"formGroupName",4,"matCellDef"],["matColumnDef","account"],["matColumnDef","lastName"],["matColumnDef","actions"],["mat-cell","","class","specialcell",3,"formGroupName",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","warn",4,"ngIf"],["mat-button","","color","primary",3,"disabled","click"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",3,"formGroupName"],["matInput","","formControlName","firstName",1,"form-control"],["type","number","matInput","","formControlName","account",1,"form-control"],["matInput","","formControlName","lastName",1,"form-control"],["mat-cell","",1,"specialcell",3,"formGroupName"],["mat-icon-button","","aria-label","Save","color","primary",3,"disabled","click"],["mat-icon-button","","color","warn",3,"click",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],["mat-icon-button","","color","warn",3,"click"],["mat-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"warn"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"h1"),t._uU(2,"Angular's dynamic table - Account Calculator"),t.qZA(),t.TgZ(3,"button",1),t.NdJ("click",function(){return n.openChangeOrderColumnsDialog()}),t._uU(4,"Switch positions of columns"),t.qZA(),t.TgZ(5,"form",2)(6,"mat-form-field"),t._UZ(7,"input",3),t.qZA(),t.TgZ(8,"div",4)(9,"table",5),t.ynx(10,6),t.YNc(11,U,2,0,"th",7),t.YNc(12,F,2,1,"td",8),t.BQk(),t.ynx(13,9),t.YNc(14,R,2,0,"th",7),t.YNc(15,D,3,1,"td",10),t.BQk(),t.ynx(16,11),t.YNc(17,k,2,0,"th",7),t.YNc(18,J,3,1,"td",10),t.BQk(),t.ynx(19,12),t.YNc(20,Y,2,0,"th",7),t.YNc(21,M,3,1,"td",10),t.BQk(),t.ynx(22,13),t.YNc(23,Q,2,0,"th",7),t.YNc(24,P,6,4,"td",14),t.BQk(),t.YNc(25,E,1,0,"tr",15),t.YNc(26,B,1,0,"tr",16),t.qZA(),t.YNc(27,H,2,0,"p",17),t.TgZ(28,"button",18),t.NdJ("click",function(){return n.addRows()}),t._uU(29," Add Row "),t.qZA()()(),t._UZ(30,"app-summary"),t.qZA()),2&e&&(t.xp6(5),t.Q6J("formGroup",n.myForm),t.xp6(4),t.Q6J("dataSource",n.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("ngIf",!n.myForm.valid),t.xp6(1),t.Q6J("disabled",!n.myForm.valid))},dependencies:[m.O5,i._Y,i.Fj,i.wV,i.JJ,i.JL,i.sg,i.u,i.x0,i.CE,h.lW,I.Hw,S.KE,A.Nt,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,O],styles:[".content[_ngcontent-%COMP%]{margin:5rem auto;width:80%;max-width:600px;min-width:380px}.content[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{margin:1rem 0}.content[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]     .mat-form-field{margin-right:1rem}.content[_ngcontent-%COMP%]   .warn[_ngcontent-%COMP%]{color:#f7910b}"]}),o})()}];let $=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[p.Bz.forChild(z),p.Bz]}),o})();var L=r(8066);let j=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[m.ez,i.u5,i.UX,$,L.q]}),o})()}}]);